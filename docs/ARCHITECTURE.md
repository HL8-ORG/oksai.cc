# Oksai SaaS å¹³å° - æ¶æ„è§„åˆ’æ–‡æ¡£

> æœ€åæ›´æ–°: 2026-03-01
>
> ## å½“å‰é¡¹ç›®çŠ¶æ€ (PoC é˜¶æ®µ)
>
> âœ… **PoC 1 å®Œæˆ** - åŸºç¡€æ¶æ„ã€API ç½‘å…³ã€è®¤è¯ç«¯ç‚¹å·²éªŒè¯

### å·²å®Œæˆ

- âœ… é¡¹ç›®ç»“æ„é‡æ„ (åˆ é™¤åŸæœ‰ç¤ºä¾‹åŒ…)
- âœ… å…±äº«åº“: `@oksai/types`, `@oksai/utils`
- âœ… æ•°æ®åº“: `@oksai/database` (Drizzle ORM + PostgreSQL)
- âœ… è®¤è¯åº“: `@oksai/nestjs-better-auth` (ä» oksai é¡¹ç›®å¤åˆ¶)
- âœ… API ç½‘å…³: `@oksai/gateway` (NestJS)
- âœ… Docker é…ç½®: PostgreSQL, Redis, RabbitMQ, MinIO, pgAdmin
- âœ… æ•°æ®åº“è¡¨å·²åˆ›å»ºå¹¶åŒæ­¥
- âœ… Gateway æœåŠ¡å¯åŠ¨æˆåŠŸ
- âœ… è®¤è¯ç«¯ç‚¹å·²åˆ›å»º (register, login, session)

### æµ‹è¯•ç»“æœ

```bash
# API æ ¹è·¯ç”±
$ curl http://localhost:3000/api
{"message":"Welcome to Oksai API Gateway","version":"0.0.1"}

# å¥åº·æ£€æŸ¥
$ curl http://localhost:3000/api/health
{"status":"ok","timestamp":"2026-03-01T01:24:58.805Z"}

# ç”¨æˆ·æ³¨å†Œ
$ curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"test123"}'
{"message":"User registration endpoint - Better Auth will handle this","email":"test@example.com"}
```

### API ç«¯ç‚¹

| æ–¹æ³• | è·¯å¾„               | æè¿°         |
| ---- | ------------------ | ------------ |
| GET  | /api               | API æ¬¢è¿ä¿¡æ¯ |
| GET  | /api/health        | å¥åº·æ£€æŸ¥     |
| GET  | /api/health/ready  | å°±ç»ªæ£€æŸ¥     |
| POST | /api/auth/register | ç”¨æˆ·æ³¨å†Œ     |
| POST | /api/auth/login    | ç”¨æˆ·ç™»å½•     |
| GET  | /api/auth/session  | è·å–ä¼šè¯     |

### å¾…å®Œæˆ

- ğŸ“‹ Better Auth æ•°æ®åº“é›†æˆ (å®é™…å­˜å‚¨ç”¨æˆ·)
- ğŸ“‹ GitHub OAuth ç™»å½•
- ğŸ“‹ å‰ç«¯åº”ç”¨ (React + radix-ui)

---

## ä¸€ã€é¡¹ç›®æ„¿æ™¯

**Oksai** - é¢å‘ç°ä»£ä¼ä¸šçš„å¤šç§Ÿæˆ· SaaS å¹³å°ï¼Œä¸ºä¸­å°ä¼ä¸šæä¾›ï¼š

- ğŸ” **ç»Ÿä¸€è®¤è¯ä¸­å¿ƒ** - å¤šç§Ÿæˆ·ã€å¤šç™»å½•æ–¹å¼ã€RBAC æƒé™ç®¡ç†
- ğŸ¤– **AI é›†æˆ** - LLM å¯¹è¯ã€å‘é‡æœç´¢ã€AI Agent ç¼–æ’
- ğŸ“¢ **æ¶ˆæ¯é€šçŸ¥åŸºç¡€è®¾æ–½** - é‚®ä»¶ã€çŸ­ä¿¡ã€WebSocketã€Webhook
- ğŸ“Š **æ•°æ®æ²»ç†å’Œåˆ†æ** - æ—¥å¿—ã€æŒ‡æ ‡ã€å®¡è®¡è¿½è¸ª

---

## äºŒã€æŠ€æœ¯æ ˆ

| å±‚çº§           | æŠ€æœ¯é€‰å‹                                    |
| -------------- | ------------------------------------------- |
| **å‰ç«¯**       | React 18 + TanStack Router/Query + radix-ui |
| **åç«¯**       | NestJS 10 + TypeScript                      |
| **æ•°æ®åº“**     | PostgreSQL + Drizzle ORM                    |
| **ç¼“å­˜**       | Redis                                       |
| **æ¶ˆæ¯é˜Ÿåˆ—**   | RabbitMQ                                    |
| **å‘é‡æ•°æ®åº“** | pgvector (PostgreSQL æ‰©å±•)                  |
| **å¯¹è±¡å­˜å‚¨**   | MinIO                                       |
| **è®¤è¯**       | Better Auth                                 |
| **éƒ¨ç½²**       | Docker Compose                              |

---

## ä¸‰ã€Monorepo æ¶æ„

```
oksai.cc/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ gateway/                    # API ç½‘å…³
â”‚   â”œâ”€â”€ auth-service/               # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ ai-service/                 # AI é›†æˆæœåŠ¡
â”‚   â”œâ”€â”€ notification-service/       # æ¶ˆæ¯é€šçŸ¥æœåŠ¡
â”‚   â”œâ”€â”€ analytics-service/          # æ•°æ®åˆ†ææœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ web-admin/                  # ç®¡ç†åå° (React + radix-ui)
â”‚   â”œâ”€â”€ web-auth/                   # è®¤è¯ä¸­å¿ƒ UI (SSO ç™»å½•é¡µ)
â”‚   â”œâ”€â”€ web-marketing/              # è¥é”€å®˜ç½‘
â”‚   â””â”€â”€ web-docs/                   # API æ–‡æ¡£ç«™ç‚¹
â”‚
â”œâ”€â”€ libs/
â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ types/                  # å…±äº«ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ constants/              # å¸¸é‡å®šä¹‰
â”‚   â”‚   â””â”€â”€ validators/             # éªŒè¯å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ src/schema/             # Drizzle Schema å®šä¹‰
â”‚   â”‚   â””â”€â”€ drizzle/                # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ infra/
â”‚   â”‚   â”œâ”€â”€ redis/                  # Redis å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ rabbitmq/               # RabbitMQ å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ minio/                  # MinIO å®¢æˆ·ç«¯
â”‚   â”‚
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ core/                   # è®¤è¯æ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ strategies/             # ç™»å½•ç­–ç•¥ (OAuth, SAML, MFA)
â”‚   â”‚   â””â”€â”€ guards/                 # NestJS Guards
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”œâ”€â”€ llm/                    # LLM é€‚é…å™¨ (GPT/Claude/æœ¬åœ°æ¨¡å‹)
â”‚   â”‚   â”œâ”€â”€ embedding/              # Embedding æœåŠ¡
â”‚   â”‚   â””â”€â”€ agents/                 # AI Agent æ¡†æ¶
â”‚   â”‚
â”‚   â”œâ”€â”€ notification/
â”‚   â”‚   â”œâ”€â”€ email/                  # é‚®ä»¶å‘é€
â”‚   â”‚   â”œâ”€â”€ sms/                    # çŸ­ä¿¡å‘é€
â”‚   â”‚   â”œâ”€â”€ websocket/              # å®æ—¶æ¨é€
â”‚   â”‚   â””â”€â”€ webhook/                # Webhook è§¦å‘
â”‚   â”‚
â”‚   â””â”€â”€ ui/                         # å…±äº« UI ç»„ä»¶åº“
â”‚       â”œâ”€â”€ components/
â”‚       â”œâ”€â”€ hooks/
â”‚       â””â”€â”€ themes/
â”‚
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ scripts/                    # æ„å»º/éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ generators/                 # Nx è‡ªå®šä¹‰ç”Ÿæˆå™¨
â”‚
â”œâ”€â”€ docker/                         # Docker é…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ docker-compose.dev.yml
â”‚   â””â”€â”€ services/
â”‚
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”‚
â””â”€â”€ .github/
    â””â”€â”€ workflows/                  # CI/CD é…ç½®
```

---

## å››ã€æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 è®¤è¯ä¸­å¿ƒ (Authentication Center)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Authentication Center                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç™»å½•æ–¹å¼                                                    â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·å/å¯†ç                                              â”‚
â”‚  â”œâ”€â”€ OAuth2 (GitHub, Google, WeChat)                        â”‚
â”‚  â”œâ”€â”€ SAML (ä¼ä¸š SSO)                                        â”‚
â”‚  â”œâ”€â”€ é‚®ç®±/çŸ­ä¿¡éªŒè¯ç                                          â”‚
â”‚  â””â”€â”€ MFA (TOTP, çŸ­ä¿¡)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ¸å¿ƒåŠŸèƒ½                                                    â”‚
â”‚  â”œâ”€â”€ å¤šç§Ÿæˆ·éš”ç¦»                                              â”‚
â”‚  â”œâ”€â”€ RBAC æƒé™ç®¡ç†                                          â”‚
â”‚  â”œâ”€â”€ Session ç®¡ç†                                           â”‚
â”‚  â”œâ”€â”€ API Key ç®¡ç†                                           â”‚
â”‚  â””â”€â”€ å®¡è®¡æ—¥å¿—                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æŠ€æœ¯å®ç°                                                    â”‚
â”‚  â”œâ”€â”€ Better Auth é›†æˆ                                        â”‚
â”‚  â”œâ”€â”€ JWT + Refresh Token                                    â”‚
â”‚  â”œâ”€â”€ Redis Session Store                                    â”‚
â”‚  â””â”€â”€ PostgreSQL ç”¨æˆ·å­˜å‚¨                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®æ¨¡å‹ (Prisma Schema)**:

```prisma
model Tenant {
  id          String   @id @default(cuid())
  name        String
  slug        String   @unique
  plan        Plan     @default(FREE)
  users       User[]
  createdAt   DateTime @default(now())
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  passwordHash  String?
  tenantId      String
  tenant        Tenant    @relation(fields: [tenantId])
  roles         Role[]
  sessions      Session[]
  mfaEnabled    Boolean   @default(false)
  createdAt     DateTime  @default(now())
}

model Role {
  id          String        @id @default(cuid())
  name        String
  permissions Permission[]
  users       User[]
}

model Session {
  id           String   @id @default(cuid())
  userId       String
  user         User     @relation(fields: [userId])
  token        String   @unique
  expiresAt    DateTime
  createdAt    DateTime @default(now())
}

enum Plan {
  FREE
  STARTER
  PRO
  ENTERPRISE
}
```

### 4.2 AI é›†æˆæœåŠ¡ (AI Service)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       AI Service                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LLM å¯¹è¯                                                    â”‚
â”‚  â”œâ”€â”€ å¤šæ¨¡å‹æ”¯æŒ (OpenAI, Anthropic, æœ¬åœ°æ¨¡å‹)                â”‚
â”‚  â”œâ”€â”€ ç»Ÿä¸€ API æŠ½è±¡                                           â”‚
â”‚  â”œâ”€â”€ æµå¼å“åº” (SSE/WebSocket)                                â”‚
â”‚  â””â”€â”€ Token è®¡è´¹                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Embedding & å‘é‡æœç´¢                                        â”‚
â”‚  â”œâ”€â”€ æ–‡æœ¬å‘é‡åŒ–                                              â”‚
â”‚  â”œâ”€â”€ pgvector å­˜å‚¨                                          â”‚
â”‚  â””â”€â”€ è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI Agent ç¼–æ’                                               â”‚
â”‚  â”œâ”€â”€ Agent å®šä¹‰ & æ‰§è¡Œ                                       â”‚
â”‚  â”œâ”€â”€ å·¥å…·è°ƒç”¨ (Function Calling)                             â”‚
â”‚  â”œâ”€â”€ å¤š Agent åä½œ                                           â”‚
â”‚  â””â”€â”€ æ‰§è¡Œå†å²è¿½è¸ª                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ¶ˆæ¯é€šçŸ¥æœåŠ¡ (Notification Service)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Notification Service                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€šçŸ¥æ¸ é“                                                    â”‚
â”‚  â”œâ”€â”€ Email (SMTP / SendGrid / é˜¿é‡Œäº‘)                       â”‚
â”‚  â”œâ”€â”€ SMS (é˜¿é‡Œäº‘ / è…¾è®¯äº‘)                                   â”‚
â”‚  â”œâ”€â”€ WebSocket (å®æ—¶æ¨é€)                                    â”‚
â”‚  â””â”€â”€ Webhook (ç¬¬ä¸‰æ–¹å›è°ƒ)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ¸å¿ƒç‰¹æ€§                                                    â”‚
â”‚  â”œâ”€â”€ æ¨¡æ¿å¼•æ“ (Handlebars)                                   â”‚
â”‚  â”œâ”€â”€ æ¶ˆæ¯é˜Ÿåˆ— (RabbitMQ)                                     â”‚
â”‚  â”œâ”€â”€ é‡è¯•æœºåˆ¶ & æ­»ä¿¡é˜Ÿåˆ—                                     â”‚
â”‚  â”œâ”€â”€ é€šçŸ¥åå¥½è®¾ç½®                                            â”‚
â”‚  â””â”€â”€ å‘é€å†å² & ç»Ÿè®¡                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äº”ã€å‰ç«¯åº”ç”¨è§„åˆ’

| åº”ç”¨              | æŠ€æœ¯æ ˆ                      | åŠŸèƒ½                                   |
| ----------------- | --------------------------- | -------------------------------------- |
| **web-admin**     | React + radix-ui + TanStack | ç§Ÿæˆ·ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€æƒé™é…ç½®ã€ç³»ç»Ÿç›‘æ§ |
| **web-auth**      | React + Tailwind            | SSO ç™»å½•é¡µã€æ³¨å†Œã€å¯†ç é‡ç½®ã€MFA éªŒè¯   |
| **web-marketing** | React + Tailwind            | äº§å“ä»‹ç»ã€å®šä»·ã€æ–‡æ¡£ã€åšå®¢             |
| **web-docs**      | VitePress / Nextra          | API æ–‡æ¡£ã€é›†æˆæŒ‡å—                     |

---

## å…­ã€æ•°æ®åº“æ¶æ„

### PostgreSQL (ä¸»åº“)

| è¡¨å               | ç”¨é€”                |
| ------------------ | ------------------- |
| `tenants`          | ç§Ÿæˆ·ä¿¡æ¯            |
| `users`            | ç”¨æˆ·ä¿¡æ¯            |
| `roles`            | è§’è‰²å®šä¹‰            |
| `permissions`      | æƒé™å®šä¹‰            |
| `sessions`         | ä¼šè¯è®°å½•            |
| `api_keys`         | API å¯†é’¥            |
| `audit_logs`       | å®¡è®¡æ—¥å¿—            |
| `notifications`    | é€šçŸ¥è®°å½•            |
| `ai_conversations` | AI å¯¹è¯å†å²         |
| `ai_embeddings`    | å‘é‡å­˜å‚¨ (pgvector) |
| `webhooks`         | Webhook é…ç½®        |

### Redis (ç¼“å­˜)

| Key Pattern    | ç”¨é€”           |
| -------------- | -------------- |
| `sessions:*`   | ä¼šè¯ç¼“å­˜       |
| `rate_limit:*` | é™æµè®¡æ•°       |
| `cache:*`      | é€šç”¨ç¼“å­˜       |
| `pubsub:*`     | WebSocket é¢‘é“ |

---

## ä¸ƒã€Docker Compose æ¶æ„

```yaml
version: '3.8'

services:
  # ========== æ•°æ®å±‚ ==========
  postgres:
    image: pgvector/pgvector:pg16
    environment:
      POSTGRES_USER: oksai
      POSTGRES_PASSWORD: oksai_dev_password
      POSTGRES_DB: oksai
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - '5432:5432'

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data
    ports:
      - '6379:6379'

  rabbitmq:
    image: rabbitmq:3-management-alpine
    environment:
      RABBITMQ_DEFAULT_USER: oksai
      RABBITMQ_DEFAULT_PASS: oksai_dev_password
    volumes:
      - rabbitmq_data:/var/lib/rabbitmq
    ports:
      - '5672:5672'
      - '15672:15672'

  minio:
    image: minio/minio
    command: server /data --console-address ":9001"
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
    volumes:
      - minio_data:/data
    ports:
      - '9000:9000'
      - '9001:9001'

  # ========== åç«¯æœåŠ¡ ==========
  gateway:
    build:
      context: .
      dockerfile: apps/gateway/Dockerfile
    environment:
      DATABASE_URL: postgresql://oksai:oksai_dev_password@postgres:5432/oksai
      REDIS_URL: redis://redis:6379
    ports:
      - '3000:3000'
    depends_on:
      - postgres
      - redis

  auth-service:
    build:
      context: .
      dockerfile: apps/auth-service/Dockerfile
    environment:
      DATABASE_URL: postgresql://oksai:oksai_dev_password@postgres:5432/oksai
      REDIS_URL: redis://redis:6379
    depends_on:
      - postgres
      - redis

volumes:
  postgres_data:
  redis_data:
  rabbitmq_data:
  minio_data:
```

---

## å…«ã€å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€è®¾æ–½ (ç¬¬ 1-2 æœˆ)

| å‘¨æ¬¡ | ä»»åŠ¡                                   |
| ---- | -------------------------------------- |
| W1-2 | é¡¹ç›®ç»“æ„é‡æ„ã€Nx é…ç½®ã€Docker åŸºç¡€è®¾æ–½ |
| W3-4 | Prisma Schema è®¾è®¡ã€æ•°æ®åº“è¿ç§»         |
| W5-6 | å…±äº«åº“å¼€å‘ (types, utils, validators)  |
| W7-8 | åŸºç¡€ CI/CDã€å¼€å‘ç¯å¢ƒå®Œå–„               |

### Phase 2: è®¤è¯ä¸­å¿ƒ (ç¬¬ 3-4 æœˆ)

| å‘¨æ¬¡   | ä»»åŠ¡                            |
| ------ | ------------------------------- |
| W9-10  | Better Auth é›†æˆã€ç”¨æˆ·/å¯†ç ç™»å½• |
| W11-12 | OAuth2 é›†æˆã€å¤šç§Ÿæˆ·å®ç°         |
| W13-14 | MFAã€SAML ä¼ä¸š SSO              |
| W15-16 | web-auth å‰ç«¯ã€RBAC æƒé™        |

### Phase 3: AI & é€šçŸ¥ (ç¬¬ 5-6 æœˆ)

| å‘¨æ¬¡   | ä»»åŠ¡                               |
| ------ | ---------------------------------- |
| W17-18 | LLM é€‚é…å™¨ã€å¯¹è¯ API               |
| W19-20 | Embedding æœåŠ¡ã€å‘é‡æœç´¢           |
| W21-22 | æ¶ˆæ¯é€šçŸ¥æœåŠ¡ (Email/SMS/WebSocket) |
| W23-24 | web-admin ç®¡ç†åå°ã€é›†æˆæµ‹è¯•       |

### Phase 4: å®Œå–„ & ä¸Šçº¿ (ç¬¬ 6+ æœˆ)

| ä»»åŠ¡                   |
| ---------------------- |
| web-marketing è¥é”€å®˜ç½‘ |
| API æ–‡æ¡£å®Œå–„           |
| æ€§èƒ½ä¼˜åŒ– & å®‰å…¨å®¡è®¡    |
| ç”Ÿäº§éƒ¨ç½² & ç›‘æ§        |

---

## ä¹ã€PoC è®¡åˆ’

### PoC 1: Better Auth å¤šç§Ÿæˆ·è®¤è¯ (ä¼˜å…ˆçº§æœ€é«˜)

**ç›®æ ‡**: éªŒè¯ Better Auth åœ¨å¤šç§Ÿæˆ·åœºæ™¯ä¸‹çš„å¯è¡Œæ€§

**éªŒè¯å†…å®¹**:

- [ ] Better Auth + NestJS é›†æˆ
- [ ] å¤šç§Ÿæˆ·ç”¨æˆ·éš”ç¦»
- [ ] OAuth2 (GitHub) ç™»å½•
- [ ] JWT Token ç”Ÿæˆ/éªŒè¯
- [ ] Redis Session å­˜å‚¨

**é¢„æœŸäº§å‡º**: å¯è¿è¡Œçš„è®¤è¯æœåŠ¡ Demo

**å®æ–½æ­¥éª¤**:

| æ­¥éª¤ | æ“ä½œ                                                |
| ---- | --------------------------------------------------- |
| 1    | åˆ é™¤ `packages/strings`, `colors`, `async`, `utils` |
| 2    | åˆ›å»º `libs/shared/types`, `libs/shared/utils`       |
| 3    | åˆ›å»º `libs/database/prisma`                         |
| 4    | åˆ›å»º `apps/gateway` (NestJS API ç½‘å…³)               |
| 5    | åˆ›å»º `apps/auth-service` (NestJS + Better Auth)     |
| 6    | é…ç½® `docker-compose.yml` (PostgreSQL + Redis)      |

### PoC 2: pgvector å‘é‡æœç´¢

**ç›®æ ‡**: éªŒè¯ PostgreSQL + pgvector çš„å‘é‡æœç´¢èƒ½åŠ›

**éªŒè¯å†…å®¹**:

- [ ] pgvector Docker å®¹å™¨å¯åŠ¨
- [ ] Embedding ç”Ÿæˆ (OpenAI API)
- [ ] å‘é‡å­˜å‚¨ & ç›¸ä¼¼åº¦æœç´¢
- [ ] Prisma + pgvector å…¼å®¹æ€§

### PoC 3: NestJS å¾®æœåŠ¡ + RabbitMQ

**ç›®æ ‡**: éªŒè¯å¾®æœåŠ¡é—´é€šä¿¡æ¶æ„

**éªŒè¯å†…å®¹**:

- [ ] NestJS å¾®æœåŠ¡æ¨¡å¼
- [ ] RabbitMQ æ¶ˆæ¯é˜Ÿåˆ—
- [ ] æœåŠ¡é—´ RPC è°ƒç”¨
- [ ] äº‹ä»¶å‘å¸ƒ/è®¢é˜…

### PoC 4: React + TanStack + radix-ui

**ç›®æ ‡**: éªŒè¯å‰ç«¯æŠ€æœ¯æ ˆæ•´åˆ

**éªŒè¯å†…å®¹**:

- [ ] Vite + React 18 é¡¹ç›®
- [ ] TanStack Router + Query
- [ ] radix-ui ç»„ä»¶åº“
- [ ] è®¤è¯çŠ¶æ€ç®¡ç†

---

## åã€æŠ€æœ¯å†³ç­–è®°å½•

### ADR-001: ä¸ºä»€ä¹ˆé€‰æ‹© Better Auth?

- **å¼€æºè‡ªæ‰˜ç®¡**: æ— éœ€ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡
- **å¤šç§Ÿæˆ·æ”¯æŒ**: åŸç”Ÿæ”¯æŒå¤šç§Ÿæˆ·æ¶æ„
- **ä¸°å¯Œçš„ Provider**: æ”¯æŒ GitHub, Google, SAML ç­‰
- **TypeScript ä¼˜å…ˆ**: ç±»å‹å®‰å…¨

### ADR-002: ä¸ºä»€ä¹ˆé€‰æ‹© pgvector?

- **PostgreSQL ç”Ÿæ€**: æ— éœ€å¼•å…¥æ–°çš„æ•°æ®åº“
- **æˆæœ¬ä½**: ç›¸æ¯”ä¸“ç”¨å‘é‡æ•°æ®åº“ (Pinecone, Weaviate)
- **Prisma æ”¯æŒ**: å¯ä»¥é€šè¿‡æ‰©å±•é›†æˆ

### ADR-003: ä¸ºä»€ä¹ˆé€‰æ‹© Docker Compose?

- **å¼€å‘ç®€å•**: ç›¸æ¯” Kubernetesï¼Œé…ç½®æ›´ç®€å•
- **é€‚åˆä¸­å°ä¼ä¸š**: åˆæœŸè§„æ¨¡ä¸éœ€è¦ K8s çš„å¤æ‚æ€§
- **æ˜“äºè¿ç§»**: åæœŸå¯ä»¥è¿ç§»åˆ° K8s

---

## åä¸€ã€ç›¸å…³æ–‡æ¡£

- [API è®¾è®¡è§„èŒƒ](./API_DESIGN.md) (å¾…åˆ›å»º)
- [æ•°æ®åº“è¿ç§»æŒ‡å—](./DATABASE_MIGRATION.md) (å¾…åˆ›å»º)
- [éƒ¨ç½²æŒ‡å—](./DEPLOYMENT.md) (å¾…åˆ›å»º)
- [å®‰å…¨æœ€ä½³å®è·µ](./SECURITY.md) (å¾…åˆ›å»º)

# Workflow 翻译决策

## ADR-001：预翻译 vs 按需翻译

### 背景

需要决定翻译生成时机：在 workflow 保存时生成，还是发送时生成。

### 备选方案

1. **发送时按需翻译** —— 向参会人发送时翻译，并缓存复用
   - 优点：API 调用更少，不会产生未使用翻译
   - 缺点：首次发送到新语言时会有轻微延迟

2. **保存时预翻译** —— workflow 保存时一次性翻译到 19 种语言
   - 优点：发送时无延迟，且与 event type 模式一致
   - 缺点：前期 API 调用更多

### 决策

采用保存时预翻译（方案 2），以对齐现有 event type 翻译模式，并保证发送通知时无延迟。

### 影响

- workflow step 保存后，通过异步 tasker 任务生成翻译
- 每个 workflow step 约 36 次 API 调用（18 种语言 × 2 个字段）
- 数据库预先存储所有翻译

## ADR-002：仅面向组织用户

### 背景

需要决定该功能是面向所有用户开放，还是受限开放。

### 决策

仅组织用户可用，与 event type 自动翻译功能保持一致。

### 影响

- UI 开关仅对组织用户显示
- handler 在触发翻译前检查 `ctx.user.organizationId`
